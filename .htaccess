# --------------------------------------------------
# Enable Rewrite Engine
# --------------------------------------------------
RewriteEngine On

# --------------------------------------------------
# Default index
# --------------------------------------------------
DirectoryIndex index.php index.html

# --------------------------------------------------
# REMOVE EXTENSION FROM URL
# /page.php → /page
# /page.html → /page
# --------------------------------------------------
RewriteCond %{THE_REQUEST} \s([^.]+)\.(php|html)[\s?] [NC]
RewriteRule ^ %1 [R=301,L]

# --------------------------------------------------
# ALLOW ACCESS WITHOUT EXTENSION
# /page → page.php or page.html
# --------------------------------------------------
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f

RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ $1.php [L]

RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+)$ $1.html [L]

# --------------------------------------------------
# PREVENT DIRECTORY LISTING
# --------------------------------------------------
Options -Indexes

# --------------------------------------------------
# BLOCK ACCESS TO SENSITIVE FILES
# --------------------------------------------------
<FilesMatch "(^\.|composer\.(json|lock)|package(-lock)?\.json|\.env|\.git|\.svn)">
    Order allow,deny
    Deny from all
</FilesMatch>

# --------------------------------------------------
# PROTECT CONFIG FILES
# --------------------------------------------------
<FilesMatch "(config|database|settings)\.(php|ini|log)">
    Order allow,deny
    Deny from all
</FilesMatch>

# --------------------------------------------------
# SECURITY HEADERS
# --------------------------------------------------
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# --------------------------------------------------
# DENY ACCESS TO .HTACCESS
# --------------------------------------------------
<Files .htaccess>
    Order allow,deny
    Deny from all
</Files>